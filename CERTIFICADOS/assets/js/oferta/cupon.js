$(".modal-cupon-close").on("click",function(e){e.preventDefault();$("#modal-cupon").modal("hide")});const cupon=(year,month,day,hour,minute)=>{simplyCountdown("#cupon-fecha-fin",{year:year,month:month,day:day,hours:hour,minutes:minute,seconds:00,words:{days:"Día",hours:"Hora",minutes:"Minuto",seconds:"Segundo",pluralLetter:"s",},plural:true,inline:false,inlineClass:"simply-countdown-inline",enableUtc:false,onEnd:function(){location.reload()},refresh:1000,sectionClass:"simply-section",amountClass:"simply-amount",wordClass:"simply-word",zeroPad:false,countUp:false,})};fecha_fin=$("#fecha_final").val();if(fecha_fin!=undefined){fecha_fin=fecha_fin.split(" ");fecha=fecha_fin[0].split("-");hora=fecha_fin[1].split(":");cupon(fecha[0],fecha[1],fecha[2],hora[0],hora[1])}const ocultar_boton_buscar=()=>{$(".btn-buscar-ci").attr("mdb-animation","fade-in-left");$(".btn-buscar-ci").parent().hide();$("#ci_cupon").parent().addClass("col-lg-12");$("#ci_cupon").parent().removeClass("col-lg-9")};const mostrar_boton_buscar=()=>{$(".btn-buscar-ci").attr("mdb-toggle","animation");$(".btn-buscar-ci").attr("mdb-animation-reset","true");$(".btn-buscar-ci").attr("mdb-animation","fade-in-right");$(".btn-buscar-ci").parent().show();$("#ci_cupon").parent().addClass("col-lg-9");$("#ci_cupon").parent().removeClass("col-lg-12")};const mostrar_formulario=()=>{$("#form-inscripcion").show();$("#form-inscripcion").attr("mdb-toggle","animation");$("#form-inscripcion").attr("mdb-animation-reset","true");$("#form-inscripcion").attr("mdb-animation","fade-in-right")};const ocultar_formulario=()=>{$("#form-inscripcion").attr("mdb-animation","fade-in-left");$("#form-inscripcion").hide()};const limpiar_formulario=(ci)=>{$("#frm_inscripcion_cupon").trigger("reset");$("#ci_cupon").val(ci);$("#id_participante_cupon").val("")};$(".button-cupon").click(function(){ocultar_boton_buscar();$("#form-inscripcion").hide();$("#modal-cupon").modal("show")});$("#modal-cupon").on("shown.bs.modal",function(){$("#ci_cupon").focus()});$("#ci_cupon").on("keyup change",function(e){e.preventDefault();if($(this).val().length>3){mostrar_boton_buscar()}else{ocultar_boton_buscar();ocultar_formulario()}ocultar_formulario()});$(".btn-buscar-ci").click(function(){const ci=$("#ci_cupon").val();if(ci.length>3){$.ajax({url:window.location.origin+"/buscar_ci",type:"POST",data:{ci:ci,},}).done(function(response){if(response.datos.length>0){if(typeof response.datos!="undefined"){$("#id_participante_cupon").val(response.datos[0].id_participante);$("#expedido_cupon").val(response.datos[0].expedido).trigger("change");$("#correo_cupon").val(response.datos[0].correo);$("#nombre_cupon").val(response.datos[0].nombre);$("#paterno_cupon").val(response.datos[0].paterno);$("#materno_cupon").val(response.datos[0].materno);$("#celular_cupon").val(response.datos[0].celular)}}else{limpiar_formulario(ci)}mostrar_formulario();ocultar_boton_buscar()})}});const parametrosEnvio=(activarDesactivar,iconoEnviarFormulario)=>{e=$(`#${iconoEnviarFormulario}`);e.removeClass();if(activarDesactivar){e.addClass("mdi mdi-plus-circle");e.parent().attr("disabled",false)}else{e.addClass("fa fa-spin fa-spinner");e.parent().attr("disabled",true)}};const agregar_animacion_icono=(name,clase)=>{$("#btn-inscribir-cupon").prop("disabled",true);$(".button-cupon-submit").html("<i class='fa fa-spin fa-spinner text-white button-reservar-cupon-icono' style='margin-bottom: 5px;'></i> GENERANDO PDF ...");$("."+name).removeClass(clase)};const quitar_animacion_icono=(name,clase)=>{$("#btn-inscribir-cupon").prop("disabled",false);$(".button-cupon-submit").html("<i class='fas fa-save text-white button-reservar-cupon-icono' style='margin-bottom: 5px;'></i> RESERVAR MI CUPÓN");$("."+name).removeClass(clase)};let btnActualizar="button-reservar-cupon";$("#frm_inscripcion_cupon").on("submit",function(e){e.preventDefault();agregar_animacion_icono("button-reservar-cupon-icono","fas fa-save");$.ajax({url:$(this).attr("action"),type:"post",data:$(this).serialize(),dataType:"json",}).done(function(response){if(typeof response.warning!="undefined"){Swal.fire("Advertencia!",response.warning,"warning");quitar_animacion_icono("button-reservar-cupon-icono","fa fa-spin fa-spinner");$("#frm_inscripcion_cupon").trigger("reset");$("#modal-cupon").modal("hide")}if(typeof response.numero!="undefined"){agregar_animacion_icono("button-reservar-cupon-icono","fas fa-save ");$("#numero").val(response.numero);$("#codigo").val(response.codigo);generar_pdf(response.numero,response.codigo);$("#whatsapp").attr("celular",response.celular);$("#whatsapp").attr("cupon",response.cupon);$("#whatsapp").attr("nombre",response.nombre)}}).fail(function(){parametrosEnvio(true,`${btnActualizar}-icono`);Swal.fire("Advertencia!",jqXHR.responseJSON.error,"error")})});const generar_pdf=(numero,codigo)=>{window.open(window.location.origin+"/descargar-pdf-cupon/?numero="+numero+"&codigo="+codigo,"_blank");quitar_animacion_icono("button-reservar-cupon-icono","fa fa-spin fa-spinner")};$(".close-modal-cupon").on("click",function(e){$("#modal-cupon").modal({backdrop:"static",keyboard:true,});$("#form-inscripcion").show()});$(".cerrar-formulario-registro").on("click",function(e){$("#frm_inscripcion_cupon").trigger("reset")});